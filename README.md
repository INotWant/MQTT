# MQTT

## 概述
### 目标
基于 `Netty` 较完整的实现 `MQTT3.1`协议。有以下几点说明：
                              
1. 有关 MQTT 协议的介绍，请见 [官网](http://mqtt.org/ "MQTT") 或者阅读 docs 文件夹下的相关文件
2. 针对 MQTT 协议的版本号：`v3.1.1`
3. 此处只实现 MQTT 的 `broker` 端

### 几点注意
1. 客户端标识符
    - ~~发来的 CONNECT 报文，将都会携带 “客户端标识符”。并且标识符符合规范，且与其他客户端无重复。~~
    - ~~更改为 **只能由** 服务端产生标识符。~~
    - 客户端即可以携带 “标识符”，也可以不携带（此时由服务端生成，此时不能保留会话状态）
2. 遗嘱
    - 注意：遗嘱不属于“会话状态”，所以发布后删除，除非是“保留”遗嘱
    - 保留遗嘱的删除 --> 删除方式同普通 “保留消息” 的

### **未实现**
1. 持久化
    - 含用户名 & 密码验证
2. 以 $ 开头的消息（系统消息）
3. 部分异常可能没有考虑

## 测试

###  测试列表
1. 订阅
    - 订阅 Qos0
      - [x] 发布 Qos0   
      - [x] 发布 Qos1   
      - [x] 发布 Qos2   
    - 订阅 Qos1
      - [x] 发布 Qos0   
      - [x] 发布 Qos1   
      - [x] 发布 Qos2  
    - 订阅 Qos2
      - [x] 发布 Qos0   
      - [x] 发布 Qos1   
      - [x] 发布 Qos2
    - [ ] 更替订阅
    - [ ] 取消订阅
    - [ ] 批量订阅
2. 保留会话
    - [x] 会话恢复
    - [x] 会话清除
    - [ ] 未确认消息再发布（作为发送者）
    - [ ] 未确认消息再发布（作为接受者）
    - [x] 离线期间订阅消息发布
3. KeepAlive
    -[x] 默认 keep alive
    -[x] 携带 keep alive
4. 遗嘱
    -[x] 遗嘱发布
    -[x] Disconnect 抛弃遗嘱
5. 保留消息
    -[x] 保留消息发布
    -[x] 保留消息清除

由于特殊测试环境要求等因素，上面有几项测试未完成。但有足够理由相信它是正确的！
 
### 压力测试 & 自动化测试？
不熟悉的领域，没有做，尚待探索。。。
